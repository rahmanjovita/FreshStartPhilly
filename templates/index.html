<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Philly Reentry Navigator</title>
  </head>
  <body>
    <h1>Find Resources in Philadelphia</h1>

    <!-- Location input form -->
    <label for="location">Enter Your Location:</label>
    <input
      type="text"
      id="location"
      placeholder="Enter your city or neighborhood"
    />

    <h2>Check the boxes that apply to you:</h2>

    <!-- Checkboxes for different needs -->
    <div>
      <input type="checkbox" id="food" name="needs" value="food" />
      <label for="food">Food</label>
    </div>
    <div>
      <input type="checkbox" id="housing" name="needs" value="housing" />
      <label for="housing">Housing</label>
    </div>
    <div>
      <input
        type="checkbox"
        id="mentalHealth"
        name="needs"
        value="mental_health"
      />
      <label for="mentalHealth">Mental Health</label>
    </div>
    <div>
      <input type="checkbox" id="jobSearch" name="needs" value="job_search" />
      <label for="jobSearch">Job Search</label>
    </div>
    <div>
      <input type="checkbox" id="childCare" name="needs" value="child_care" />
      <label for="childCare">Child Care</label>
    </div>
    <div>
      <input
        type="checkbox"
        id="medicalCare"
        name="needs"
        value="medical_care"
      />
      <label for="medicalCare">Medical Care</label>
    </div>
    <div>
      <input type="checkbox" id="education" name="needs" value="education" />
      <label for="education">Education</label>
    </div>

    <!-- Submit button -->
    <button onclick="fetchResources()">Find Resources</button>

    <!-- Display results -->
    <pre id="results"></pre>

    <script>
      function fetchResources() {
        // Get the user's location
        let location = document.getElementById("location").value;

        // Get the selected needs (checkboxes that are checked)
        let needs = [];
        const checkboxes = document.querySelectorAll(
          'input[name="needs"]:checked'
        );
        checkboxes.forEach((checkbox) => {
          needs.push(checkbox.value);
        });

        // Send location and needs to the server via POST request
        fetch("/get_resources", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ location, needs }),
        })
          .then((response) => response.json())
          .then((data) => {
            // Display the results from the server
            if (data.resources) {
              document.getElementById("results").innerText = data.resources;
            } else if (data.error) {
              document.getElementById("results").innerText =
                "Error: " + data.error;
            }
          })
          .catch((error) => console.error("Error:", error));
      }
    </script>
  </body>
</html>
